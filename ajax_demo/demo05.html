<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>在此处插入标题</title>
<script language='javascript' src='public.js'></script>
<script>
	var xhr;
	window.onload = function() {

		//绑定失去焦点事件
		$('username').onblur = function() {
			//获取用户名
			var username = $('username').value;
			//生成url

			//随机数
			//var url = 'demo05.php?username=' + username+'&_='+Math.random();

			//时间戳
			//var url = 'demo05.php?username=' + username+'&_='+new Date().getTime();

			var url = 'demo05.php?username=' + username;
			//创建对象
			xhr = createXhr();
			//初始化对象
			xhr.open('get', url);
			//设置请求头信息
			//xhr.setRequestHeader("If-Modified-Since", "0");
			//设置回调函数
			xhr.onreadystatechange = display;
			//发送请求
			xhr.send(null);

		};
	};

	function display() {
		//当状态码为4，响应状态码为200时
		if (xhr.readyState == 4 && xhr.status == 200) {
			//用户名已被使用
			if (xhr.responseText) {
				$('result').innerHTML = '<font color=red>用户名已被占用！</font>';
			} else {
				$('result').innerHTML = '<font color=green>用户名可以使用！</font>';
			}
		}
	}
</script>
</head>
<body>
	<form>
		用户：
		<input type='text' id='username' />
		<span id='result'></span>
		<hr>
		密码：
		<input type='password' id='password' />
		<hr>
		确认：
		<input type='password' id='password2' />
		<hr>
		<input type='submit' name='submit' value='注册' />
	</form>
</body>
</html>